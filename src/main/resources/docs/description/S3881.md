The `IDisposable` interface is a mechanism to release unmanaged resources, if not implemented correctly this could result in resource
leaks or more severe bugs.

This rule raises an issue when the recommended dispose pattern, as defined by Microsoft, is not adhered to.

In particular the `Dispose()` method should only contain the following code:

<pre>
public void Dispose()
{
    Dispose(true);
    GC.SuppressFinalize(this);
}
</pre>

Specifically this rule checks for these problems:

*   `Dispose()` is virtual.
*   `Dispose()` is not public.
*   An exception is thrown inside `Dispose()` or `Dispose(bool)`.
*   This is an unsealed type and `Dispose(bool)` is not `protected virtual`.
*   This is an unsealed type and `Dispose()` doesn't match the implementation above.
*   This is an unsealed type and the finalizer doesn't call `Dispose(bool)` or the class finalizer.

## Noncompliant Code Example

<pre>
public class Foo : IDisposable // Noncompliant - provide protected overridable implementation of Dispose(bool) on Foo or mark the type as sealed.
{
    public void Dispose() // Noncompliant - should contain only a call to Dispose(true) and then GC.SuppressFinalize(this)
    {
        // Cleanup
    }
}

public class Foo : IDisposable
{
    void IDisposable.Dispose() // Noncompliant - Dispose() should be public
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    public virtual void Dispose() // Noncompliant - Dispose() should be sealed
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }
}

public class Foo : IDisposable
{
    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing)
    {
        // Cleanup
    }

    ~Foo() // Noncompliant - Modify Foo.~Foo() so that it calls Dispose(false) and then returns.
    {
        // Cleanup
    }
}{code}
</pre>

## Compliant Solution

<pre>
public sealed class Foo : IDisposable
{
    public void Dispose()
    {
        // Cleanup
    }
}

public class Foo : IDisposable
{
    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing)
    {
        // Cleanup
    }
}

public class Foo : IDisposable
{
    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing)
    {
        // Cleanup
    }

    ~Foo()
    {
        Dispose(false);
    }
}
</pre>